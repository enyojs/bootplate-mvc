 <!-- generated from template for roller.js -->      <div class="file">   <div>     <span class="title">Roller.js</span>     <span class="path">source/views/Main/Roller/Roller.js</span>   </div>             <div class="group">       <div class="comments">                </div>       <div class="source">         <div class="highlight"><pre></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <h2>The <code>Sample.Roller</code> kind</h2>

<p>The <code>Sample.Roller</code> kind is a modified <code>enyo.Panels</code> housed in a
container that dynamically creates panels based on the models in
a collection. In this case, the collection is proxied via our
panels controller, <code>Sample.panels</code>.</p>       </div>       <div class="source">         <div class="highlight"><pre><span class="nx">enyo</span><span class="p">.</span><span class="nx">kind</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Sample.Roller&quot;</span><span class="p">,</span>
    <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;roller&quot;</span><span class="p">,</span>
    <span class="nx">classes</span><span class="o">:</span> <span class="s2">&quot;roller-container&quot;</span><span class="p">,</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>To receive events and have a relative path to the controller,
we set <code>Sample.panels</code> as our view's controller.</p>       </div>       <div class="source">         <div class="highlight"><pre>    <span class="nx">controller</span><span class="o">:</span> <span class="s2">&quot;Sample.panels&quot;</span><span class="p">,</span>
    <span class="nx">handlers</span><span class="o">:</span> <span class="p">{</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>We need to provide our own handler for the event
that's bubbling up from the collection controller.</p>       </div>       <div class="source">         <div class="highlight"><pre>        <span class="nx">oncollectionadd</span><span class="o">:</span> <span class="s2">&quot;didAddModel&quot;</span>
    <span class="p">},</span>
    <span class="nx">bindings</span><span class="o">:</span> <span class="p">[</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>We've bound the <code>isEditing</code> state property to a local <code>isEditing</code>
property so we can get change notifications; this is a two-way
binding.</p>       </div>       <div class="source">         <div class="highlight"><pre>        <span class="p">{</span><span class="nx">from</span><span class="o">:</span> <span class="s2">&quot;.controller.isEditing&quot;</span><span class="p">,</span> <span class="nx">to</span><span class="o">:</span> <span class="s2">&quot;.isEditing&quot;</span><span class="p">,</span> <span class="nx">oneWay</span><span class="o">:</span> <span class="kc">false</span><span class="p">},</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>We bind our child's <code>index</code> property to our controller's <code>index</code>
property in a two-way binding.</p>       </div>       <div class="source">         <div class="highlight"><pre>        <span class="p">{</span><span class="nx">from</span><span class="o">:</span> <span class="s2">&quot;.$.panels.index&quot;</span><span class="p">,</span> <span class="nx">to</span><span class="o">:</span> <span class="s2">&quot;.controller.index&quot;</span><span class="p">,</span> <span class="nx">oneWay</span><span class="o">:</span> <span class="kc">false</span><span class="p">}</span>
    <span class="p">],</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>Not only have we wrapped the <code>enyo.Panels</code> views in this wrapper,
we've also set a very important property, <code>controller</code>, to the
panels controller (which happens to be a collection controller),
thus giving us access to the collection and its events as well as
sending our events back to the controller.</p>       </div>       <div class="source">         <div class="highlight"><pre>    <span class="nx">components</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;panels&quot;</span><span class="p">,</span> <span class="nx">margin</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;enyo.Panels&quot;</span><span class="p">,</span> <span class="nx">draggable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;roller-panels&quot;</span><span class="p">,</span> <span class="nx">wrap</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">arrangerKind</span><span class="o">:</span> <span class="s2">&quot;enyo.TopBottomArranger&quot;</span><span class="p">}</span>
    <span class="p">],</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>This method handles the event notifying us that a new model has
been added. The event is dispatched from the panels controller.</p>       </div>       <div class="source">         <div class="highlight"><pre>    <span class="nx">didAddModel</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">sender</span><span class="p">,</span> <span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">model</span><span class="p">;</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>So we create a panel from the new model.</p>       </div>       <div class="source">         <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">createPanelForModel</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>We update the index of our actual <code>enyo.Panels</code> child to that
of the new model so it is the one visible.</p>       </div>       <div class="source">         <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">panels</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">controller</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">model</span><span class="p">));</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>We set our (two-way) binding state for <code>isEditing</code> to <code>true</code> so
the editor will become visible. Obviously, this is an indirect
reaction to the state change. This view does not need to be aware
of any details in the rest of the app.</p>       </div>       <div class="source">         <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;isEditing&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">},</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>Creates a panel for a model.</p>       </div>       <div class="source">         <div class="highlight"><pre>    <span class="nx">createPanelForModel</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">panel</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">panels</span><span class="p">.</span><span class="nx">createComponent</span><span class="p">({</span><span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;Sample.RollerPanel&quot;</span><span class="p">});</span>
        <span class="nx">panel</span><span class="p">.</span><span class="nx">controller</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="nx">model</span><span class="p">);</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>Forcing a render here ensures that the new panel will correctly
position itself among the other existing panels.</p>       </div>       <div class="source">         <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
    <span class="p">},</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>Synchronizes any models in the collection to panels
we now need in our roller.</p>       </div>       <div class="source">         <div class="highlight"><pre>    <span class="nx">syncPanelsToCollection</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">enyo</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">controller</span><span class="p">.</span><span class="nx">models</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">createPanelForModel</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span>
        <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">},</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>Does some view-centric work based on the state, adding and
removing classes, and thus triggering transitions in browsers
that support them.</p>       </div>       <div class="source">         <div class="highlight"><pre>    <span class="nx">isEditingChanged</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isEditing</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">))</span> <span class="k">this</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;editing&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s2">&quot;editing&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;editing&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span></pre></div>       </div>     </div>             <div class="group">       <div class="comments">         <p>We need to synchronize our collection (if any records already exist)
when we're initialized so we overload our <code>create</code> method to
execute our <code>syncPanelsToCollection</code> method to get caught up.</p>       </div>       <div class="source">         <div class="highlight"><pre>    <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">inherited</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">syncPanelsToCollection</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">});</span>

</pre></div>       </div>     </div>    </div>